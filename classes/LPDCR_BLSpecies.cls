/******************************************************************************
 * Custom class to represent the data returned from the 
 * LPDCR_ContentServiceUtil.getSpecies() callout
 *
 * Generated by JSON2Apex http://json2apex.herokuapp.com/
 * 
 * @Author: Magnet 360
 * @Date: Mar 23, 2017 
 * @Jira: LPDCR-2230
 */

public with sharing class 
LPDCR_BLSpecies
    extends LPDCR_ContentCalloutResponse
{

    public class PurinaBusinessLink_Species_Z {
        public List<PurinaBusinessLink_Species> PurinaBusinessLink_Species;
        public List<TotalRecords> TotalRecords;
    }

    public class PurinaBusinessLink_Species
        implements Comparable
    {
        public String Description { get; set; }
        public String PageContent { get; set; }
        public String Image { get; set; }
        public String Name { get; set; }
        public Integer SpeciesID { get; set; }
        public String Headline { get; set; }
        public String BusinessBuilderNavigatorGuid{get;set;}
        public Boolean IsActive{get;set;}
        public String BusinessBuilderNavigatorLastModified{get;set;}
    
        /**********************************************************************
         * CompareTo method to sort the species by name
         */
        public
        Integer
        compareTo( Object a_compare_to )
        {
            PurinaBusinessLink_Species l_specie = ( PurinaBusinessLink_Species ) a_compare_to;
            
            if( Name > l_specie.Name )
            {
                return 1;
            }
            else
            {
                return 0;
            }
        }
    }// /END PurinaBusinessLink_Species inner class

    public class TotalRecords {
        public String TotalRecords;
    }

    public List<PurinaBusinessLink_Species_Z> PurinaBusinessLink_Species;
    
    public static LPDCR_BLSpecies parse( String json ) {
        
        LPDCR_BLSpecies l_response = new LPDCR_BLSpecies();

        try
        {
            l_response = (LPDCR_BLSpecies) System.JSON.deserialize(json, LPDCR_BLSpecies.class);
            l_response.success = true;
        }
        catch( Exception l_ex )
        {
            LPDCR_ParsingException l_exception = new LPDCR_ParsingException( 'LPDCR_BLSpecies',
                                                                             json,
                                                                             l_ex );
            
            LOLUtilities.LogErrMsg( 'LPDCR_BLSpecies.parse()',
                                    l_ex,
                                    ': Message = '
                                    + l_ex.getMessage()
                                    + ' : Param JSON = ' + json );

            throw l_exception;
        }
        
        return l_response;
    }
    
/******************************************************************************
 * Method to simplify returning the list of species information 
 */
    public
    List<PurinaBusinessLink_Species>
    getSpeciesList()
    {
        System.debug( 'START: LPDCR_BLSpecies.getSpeciesList()' );
        
        List<PurinaBusinessLink_Species> l_list = new List<PurinaBusinessLink_Species>();
        PurinaBusinessLink_Species l_other_specie;
        
        if( PurinaBusinessLink_Species != null )
        {
            for( PurinaBusinessLink_Species_Z species_info : PurinaBusinessLink_Species )
            {
                if( species_info.PurinaBusinessLink_Species != null )
                {
                    for( PurinaBusinessLink_Species l_specie : species_info.PurinaBusinessLink_Species )
                    {
                        if( l_specie.Image != null && l_specie.Image.startsWith( '~/' ) )
                        {
                                                 // Add the URL prefix for the
                                                 // image source if it is not set
                            l_specie.Image = l_specie.Image.replace( '~', LPDCR_Org_Settings__c.getInstance().Kentico_Resource_URL_Prefix__c );
                        }
                                                 // Make sure the 'Other' specie category is 
                                                 // at the end of the list
                        if( l_specie.Name == 'Other' )
                        {
                            l_other_specie = l_specie;
                        }
                        else
                        {
                            l_list.add( l_specie );
                        }
                    }
                }// /END if( species_info.PurinaBusinessLink_Species != null )
            }// /END for( PurinaBusinessLink_Species )
        }// /END if( PurinaBusinessLink_Species != null )
        
                                                 // Make sure the 'Other' specie category is 
                                                 // at the end of the list
        l_list.sort();
        if( l_other_specie != null )
        {
            l_list.add( l_other_specie );
        }
        
        System.debug( 'Return: l_list = ' + l_list );
        System.debug( 'END: LPDCR_BLSpecies.getSpeciesList()' );
        
        return l_list;
    }
    
}// /END Class